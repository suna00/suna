[
  {
    "typeId": "apiConfig",
    "category": "mbrContsAtvy",
    "apiId": "IfLike001",
    "apiName": "콘텐츠별 LIKE(찜) 집계 현황",
    "method": "GET",
    "parameters": [
      {
        "paramName": "contsMetaDivCd",
        "required": true
      },
      {
        "paramName": "contsMetaId",
        "required": true
      }
    ],
    "config": {
      "typeId": "code",
      "query": [
        {
          "field": "groupCodeId",
          "method": "matching",
          "value": "contsMetaDivTid"
        },
        {
          "field": "codeId",
          "method": "matching",
          "value": "{{:contsMetaDivCd}}"
        }
      ],
      "response": {
        "contsMetaDivCd": {
          "value": "{{:contsMetaDivCd}}"
        },
        "contsMetaId": {
          "value": "{{:contsMetaId}}"
        },
        "getposreNum": {
          "select": {
            "ds": "cjDb",
            "resultType": "value",
            "sql": "select count(*) as posreNum from contsLikeInfo where contsMetaDivCd = @{contsMetaDivCd} and contsMetaId = concat(@{name},'::',@{contsMetaId})"
          }
        }
      }
    }
  },
  {
    "typeId": "apiConfig",
    "category": "mbrContsAtvy",
    "apiId": "IfLike002",
    "apiName": "콘텐츠 LIKE(찜) 등록",
    "method": "POST",
    "parameters": [
      {
        "paramName": "contsMetaDivCd",
        "required": true
      },
      {
        "paramName": "contsMetaId",
        "required": true
      },
      {
        "paramName": "snsKey",
        "required": true
      },
      {
        "paramName": "snsTypeCd",
        "required": true
      }
    ],
    "config": {
      "getContsMetaDivTid": {
        "typeId": "code",
        "resultType": "none",
        "query": [
          {
            "field": "groupCodeId",
            "method": "matching",
            "value": "contsMetaDivTid"
          },
          {
            "field": "codeId",
            "method": "matching",
            "value": "{{:contsMetaDivCd}}"
          }
        ],
        "response": {
          "name": ""
        }
      },
      "chkContsLike": {
        "select": {
          "ds": "cjDb",
          "sql": "select if(count(*)>0,'false','true') likeNullYn from contsLikeInfo where contsMetaDivCd=@{contsMetaDivCd} and contsMetaId=@{makeIdValue(::,name,contsMetaId)} and mbrId = @{makeIdValue(>,snsTypeCd,snsKey)}"
        }
      },
      "root": {
        "typeId": "contsLikeInfo",
        "event": "save",
        "if":"{{:likeNullYn}}",
        "data": {
          "contsMetaDivCd": "{{:contsMetaDivCd}}",
          "contsMetaId": "{{:makeIdValue(::,name,contsMetaId)}}",
          "mbrId": "{{:makeIdValue(>,snsTypeCd,snsKey)}}"
        },
        "response": {
          "likeSeq": ""
        }
      }
    }
  },
  {
    "typeId": "apiConfig",
    "category": "mbrContsAtvy",
    "apiId": "IfLike003",
    "apiName": "콘텐츠 LIKE(찜) 취소",
    "method": "POST",
    "parameters": [
      {
        "paramName": "likeSeq",
        "required": true
      },
      {
        "paramName": "snsKey",
        "required": true
      },
      {
        "paramName": "snsTypeCd",
        "required": true
      }
    ],
    "config": {
      "typeId": "contsLikeInfo",
      "event": "delete",
      "data": {
        "likeSeq": "{{:likeSeq}}"
      },
      "response": {
        "likeSeq": ""
      }
    }
  },
  {
    "typeId": "apiConfig",
    "category": "mbrContsAtvy",
    "apiId": "IfLike004",
    "apiName": "댓글 LIKE(찜) 등록",
    "method": "POST",
    "parameters": [
      {
        "paramName": "contsReplSeq",
        "required": true
      },
      {
        "paramName": "snsKey",
        "required": true
      },
      {
        "paramName": "snsTypeCd",
        "required": true
      }
    ],
    "config": {
      "myLikeYn": {
        "select": {
          "ds": "cjDb",
          "sql": "select if(count(*)>0,'false','true') myLikeYn from replLikeInfo where replSeq=@{contsReplSeq} and mbrId = @{makeIdValue(>,snsTypeCd,snsKey)}"
        }
      },
      "root": {
        "typeId": "replLikeInfo",
        "event": "save",
        "if":"{{:myLikeYn}}",
        "data": {
          "replSeq": "{{:contsReplSeq}}",
          "mbrId": "{{:makeIdValue(>,snsTypeCd,snsKey)}}"
        },
        "response": {
          "replLikeSeq": ""
        }
      }
    }
  },
  {
    "typeId": "apiConfig",
    "category": "mbrContsAtvy",
    "apiId": "IfLike005",
    "apiName": "댓글 LIKE(찜) 취소",
    "method": "POST",
    "parameters": [
      {
        "paramName": "replSeq",
        "required": true
      },
      {
        "paramName": "snsKey",
        "required": true
      },
      {
        "paramName": "snsTypeCd",
        "required": true
      }
    ],
    "config": {
      "getReplLikeSeq": {
        "typeId": "replLikeInfo",
        "resultType": "none",
        "query": [
          {
            "field": "replSeq",
            "method": "equals",
            "value": "{{:replSeq}}"
          },
          {
            "field": "mbrId",
            "method": "equals",
            "value": "{{:makeIdValue(>,snsTypeCd,snsKey)}}"
          },
          {
            "sorting": "replLikeSeq desc",
            "limit": "1"
          }
        ],
        "response": {
          "replLikeSeq": ""
        }
      },
      "root": {
        "typeId": "replLikeInfo",
        "event": "delete",
        "data": {
          "replLikeSeq": "{{:replLikeSeq}}"
        },
        "response": {
          "replLikeSeq": ""
        }
      }
    }
  },
  {
    "typeId": "apiConfig",
    "category": "mbrContsAtvy",
    "apiId": "IfCmt001",
    "apiName": "콘텐츠별 댓글 목록조회",
    "method": "GET",
    "parameters": [
      {
        "paramName": "snsKey",
        "required": false
      },
      {
        "paramName": "snsTypeCd",
        "required": false
      },
      {
        "paramName": "contsMetaDivCd",
        "required": false
      },
      {
        "paramName": "contsMetaId",
        "required": false
      },
      {
        "paramName": "lastReplCreated",
        "required": false
      }
    ],
    "config": {
      "getContsMetaDivTid": {
        "typeId": "code",
        "resultType": "none",
        "query": [
          {
            "field": "groupCodeId",
            "method": "matching",
            "value": "contsMetaDivTid"
          },
          {
            "field": "codeId",
            "method": "matching",
            "value": "{{:contsMetaDivCd}}"
          }
        ],
        "response": {
          "name": ""
        }
      },
      "root": {
        "typeId": "replInfo",
        "query": [
          {
            "field": "contsMetaDivCd",
            "method": "matching",
            "value": "{{:contsMetaDivCd}}"
          },
          {
            "field": "contsMetaId",
            "method": "matching",
            "value": "{{:makeIdValue(::,name,contsMetaId)}}"
          },
          {
            "field": "created",
            "method": "under",
            "value": "{{:dateFormat(lastReplCreated,yyyyMMddHHmmss)}}"
          },
          {
            "sorting": "{{:sorting}}"
          },
          {
            "page": "{{:page}}",
            "pageSize": "{{:pageSize}}"
          },
          {
            "referenceView": "contsMetaId,mkerId"
          }
        ],
        "response": {
          "contsMetaDivCd": "",
          "contsMetaId": "",
          "replSeq": "",
          "replSbst": "",
          "mkerId": "",
          "replLikeNum": {
            "select": {
              "ds": "cjDb",
              "resultType": "value",
              "sql": "select count(*) replLikeNum from replLikeInfo where replSeq = @{replSeq}"
            }
          },
          "myLikeYn": {
            "select": {
              "ds": "cjDb",
              "resultType": "value",
              "sql": "select if(count(*)>0,'Y','N') myLikeYn from replLikeInfo where replSeq = @{replSeq} and mbrId = @{makeIdValue(>,snsTypeCd,snsKey)}"
            }
          },
          "dclaNum": {
            "select": {
              "ds": "cjDb",
              "resultType": "value",
              "sql": "select count(*) dclaNum from replDclaHst where replSeq = @{replSeq}"
            }
          },
          "myDclaYn": {
            "select": {
              "ds": "cjDb",
              "resultType": "value",
              "sql": "select if(count(*)>0,'Y','N') myDclaYn from replDclaHst where replSeq = @{replSeq} and dclarId = @{makeIdValue(>,snsTypeCd,snsKey)}"
            }
          },
          "dclaMaxNum": {
            "typeId": "dclaSetupMng",
            "resultType": "merge",
            "query": [
              {
                "field": "setupTypeCd",
                "method": "matching",
                "value": "1"
              },
              {
                "sorting": "dclaSetupSeq desc",
                "limit": "1"
              }
            ],
            "response": {
              "dclaMaxNum": "setupBaseCnt"
            }
          },
          "created": ""
        }
      }
    }
  },
  {
    "typeId": "apiConfig",
    "category": "mbrContsAtvy",
    "apiId": "IfCmt002",
    "apiName": "콘텐츠별 댓글 등록",
    "method": "POST",
    "parameters": [
      {
        "paramName": "contsMetaDivCd",
        "required": true
      },
      {
        "paramName": "contsMetaId",
        "required": true
      },
      {
        "paramName": "snsKey",
        "required": true
      },
      {
        "paramName": "snsTypeCd",
        "required": true
      },
      {
        "paramName": "replSbst",
        "required": true
      }
    ],
    "config": {
      "getContsMetaDivTid": {
        "typeId": "code",
        "query": [
          {
            "field": "groupCodeId",
            "method": "matching",
            "value": "contsMetaDivTid"
          },
          {
            "field": "codeId",
            "method": "matching",
            "value": "{{:contsMetaDivCd}}"
          }
        ],
        "response": {
          "name": ""
        }
      },
      "root": {
        "typeId": "replInfo",
        "event": "save",
        "data": {
          "contsMetaDivCd": "{{:contsMetaDivCd}}",
          "contsMetaId": "{{:name}}::{{:contsMetaId}}",
          "mkerId": "{{:snsTypeCd}}>{{:snsKey}}",
          "replSbst": "{{:replSbst}}"
        }
      }
    }
  },
  {
    "typeId": "apiConfig",
    "category": "mbrContsAtvy",
    "apiId": "IfCmt003",
    "apiName": "댓글 수정",
    "method": "POST",
    "parameters": [
      {
        "paramName": "contsReplSeq",
        "required": true
      },
      {
        "paramName": "snsKey",
        "required": true
      },
      {
        "paramName": "snsTypeCd",
        "required": true
      },
      {
        "paramName": "replSbst",
        "required": true
      }
    ],
    "config": {
      "typeId": "replInfo",
      "event": "save",
      "data": {
        "replSeq": "{{:contsReplSeq}}",
        "replSbst": "{{:replSbst}}"
      }
    }
  },
  {
    "typeId": "apiConfig",
    "category": "mbrContsAtvy",
    "apiId": "IfCmt004",
    "apiName": "댓글 삭제",
    "method": "POST",
    "parameters": [
      {
        "paramName": "contsReplSeq",
        "required": true
      },
      {
        "paramName": "snsKey",
        "required": true
      },
      {
        "paramName": "snsTypeCd",
        "required": true
      }
    ],
    "config": {
      "typeId": "replInfo",
      "event": "delete",
      "data": {
        "replSeq": "{{:contsReplSeq}}"
      }
    }
  },
  {
    "typeId": "apiConfig",
    "category": "mbrContsAtvy",
    "apiId": "IfCmt100",
    "apiName": "댓글 신고하기",
    "method": "POST",
    "parameters": [
      {
        "paramName": "contsReplSeq",
        "required": true
      },
      {
        "paramName": "snsKey",
        "required": true
      },
      {
        "paramName": "snsTypeCd",
        "required": true
      },
      {
        "paramName": "dclaDivCd",
        "required": true
      },
      {
        "paramName": "dclaSbst",
        "required": true
      }
    ],
    "config": {
      "typeId": "replDclaHst",
      "event": "save",
      "data": {
        "replSeq": "{{:contsReplSeq}}",
        "dclaDivCd": "{{:dclaDivCd}}",
        "dclaSbst": "{{:dclaSbst}}",
        "dclarId": "{{:snsTypeCd}}>{{:snsKey}}"
      }
    }
  }
]