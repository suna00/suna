[
  {
    "typeId": "apiCategory",
    "id": "smsCertification",
    "categoryName": "SMS 인증"
  },
  {
    "typeId": "apiConfig",
    "category": "smsCertification",
    "apiId": "req",
    "apiName": "인증코드(숫자4자리 난수발생)  sms send 넣기 ",
    "method": "GET",
    "parameters": [
    ],
    "config": {
      "getCertNumber": {
        "select" : {
          "ds" : "ytnDevDb",
          "resultType" : "read",
          "sql" : "select FLOOR(1000 + (RAND()*8999)) as certCode "
        }
      },
      "createHistory" : {
        "typeId": "smsCertification",
        "event": "create",
        "data": {
          "smsCertificationId": "{{:smsCertificationId}}",
          "name": "SMS 인증요청",
          "smsCertificationType": "{{:smsCertificationType}}",
          "adminId": "{{:adminId}}",
          "memberNo": "{{:memberNo}}",
          "cellphone": "{{:cellphone}}",
          "certCode": "{{:certCode}}",
          "certRequestDate": "{{:now}}"
        }
      }
    }
  },
  {
    "typeId": "apiConfig",
    "category": "smsCertification",
    "apiId": "cert",
    "apiName": "인증코드 유효체크 ",
    "method": "GET",
    "parameters": [
    ],
    "config": {
      "getCertNumber": {
        "select" : {
          "ds" : "ytnDevDb",
          "resultType" : "read",
          "sql" : "select smsCertificationId, certCode as lastCertCode from smscertification where cellphone = @{cellphone} order by smsCertificationId desc limit 1 "
        }
      },
      "createHistory" : {
        "typeId": "smsCertification",
        "event": "update",
        "if" : "{{:equals(lastCertCode, certCode)}}",
        "data": {
          "smsCertificationId": "{{:smsCertificationId}}",
          "certSuccessDate": "{{:now}}"
        }
      }
    }
  }
]