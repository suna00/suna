[
  {
    "typeId" : "apiCategory",
    "id" : "coupon",
    "categoryName" : "쿠폰 API"
  },
  {
    "typeId" : "apiConfig",
    "category" : "coupon",
    "apiId" : "downloadable",
    "apiName" : "다운로드 가능한 쿠폰 리스트",
    "method" : "GET",
    "parameters" : [
    ],
    "config" : {
      "categoryCoupons": {
        "select" : {
          "ds" : "ytnDevDb",
          "resultType" : "list",
          "sql" : "select a.couponTypeId from ( select couponTypeId from couponTypeToCategoryMap c, producttocategorymap p where productId=@{productId} and p.categoryId = c.categoryId group by couponTypeId ) a, coupontype b where b.couponTypeId = a.couponTypeId and b.couponType = 'category' and b.siteType != IF(IFNULL(@{siteType},'company') ='university','company', 'university') and createPeriodType != 'stop' and createStartDate <= now() and createEndDate >= now() "
        },
        "response": {
          "_all_": "",
          "couponTypeId": {
            "typeId": "couponType",
            "resultType" : "read",
            "query" : [
              {"field" : "couponTypeId", "method" : "matching", "value" : "{{:couponTypeId}}" }
            ]
          },
          "haveYn": {
            "typeId": "coupon",
            "query" : [
              {"field" : "memberNo", "method" : "matching", "value" : "{{:memberNo}}" },
              {"field" : "couponTypeId", "method" : "matching", "value" : "{{:couponTypeId}}" }
            ]
          }
        }
      },
      "productCoupons": {
        "typeId": "couponTypeToProductMap",
        "query" : [
          {"field" : "productId", "method" : "matching", "value" : "{{:productId}}" },
          {"field" : "couponTypeId", "method" : "referenceJoin", "value" : "couponType_matching=product&siteType_matching={{:siteType}}&createPeriodType_notMatching=stop&createStartDate_below={{:now}}&createEndDate_above={{:now}}" },
          {"includeReferenced" : false, "referenceView" : "couponTypeId"}
        ],
        "response": {
          "_all_": "",
          "haveYn": {
            "typeId": "coupon",
            "query" : [
              {"field" : "memberNo", "method" : "matching", "value" : "{{:memberNo}}" },
              {"field" : "couponTypeId", "method" : "matching", "value" : "{{:couponTypeId}}" }
            ]
          }
        }
      }
    }
  }
]