[
  {
    "typeId" : "apiCategory",
    "id" : "orderSheet",
    "categoryName" : "주문서 API"
  },
  {
    "typeId" : "apiConfig",
    "category" : "orderSheet",
    "apiId" : "read",
    "apiName" : "주문서 조회",
    "method" : "GET",
    "parameters" : [
    ],
    "config" : {
      "typeId" : "orderSheet",
      "query" : [
        {"field" : "orderSheetId", "method" : "matching", "value" : "{{:orderSheetId}}"},
        {"referenceView": "memberNo"}
      ],
      "response": {
        "_all_": "",
        "referencedOrderDeliveryPrice" : {
          "select": {
            "ds": "ytnDevDb",
            "resultType": "list",
            "description": "주문배송비 정보",
            "sql": "select a.orderDeliveryPriceId ,a.orderSheetId ,a.orderProductIds ,a.vendorId ,a.deliveryPrice ,a.bundleDeliveryYn ,a.deliveryMethod ,a.deliveryPriceType ,a.couponId ,a.deliveryEnterpriseId ,a.sendingDate ,a.trackingNo ,a.deliveryStatus ,a.deliveryDateType ,a.scheduledDeliveryDate ,a.hopeDeliveryDate ,a.changed ,a.created ,b.name ,b.deliverySearchUrl ,b.deliveryEnterpriseStatus from orderdeliveryprice a LEFT JOIN deliveryenterprise b on a.deliveryEnterpriseId = b.deliveryEnterpriseId where a.orderSheetId= @{orderSheetId} "
          },
          "response": {
            "_all_": "",
            "referencedOrderProduct" : {
              "typeId" : "orderProduct",
              "query" : [
                {"field" : "orderSheetId", "method" : "equals", "value" : "{{:orderSheetId}}"},
                {"field" : "orderProductId", "method" : "in", "value" : "{{:orderProductIds}}"},
                {"includeReferenced" : true, "referenceView": "productId,deliveryEnterpriseId"}
              ],
              "response": {
                "_all_": "",
                "functionBtn": {
                  "select": {
                    "ds": "ytnDevDb",
                    "resultType": "read",
                    "description": "버튼 조회 정보",
                    "sql": "SELECT if(a.orderstatus = 'order002' || a.orderstatus = 'order003', 'true', 'false') AS cancelBtn, if(b.contentsType = 'goods' && (a.orderstatus = 'order005' || a.orderstatus = 'order006'), 'true', 'false') AS exchangeBtn, if(b.contentsType = 'goods' && (a.orderstatus = 'order005' || a.orderstatus = 'order006'), 'true', 'false') AS returnBtn, (CASE WHEN b.contentsType = 'goods' THEN if((SELECT IFNULL(max(if((sendingDate + INTERVAL 30 DAY) >= now(), TRUE, FALSE)), FALSE)FROM orderdeliveryprice WHERE find_in_set(@{orderProductId}, orderProductIds) > 0) && (a.orderstatus = 'order005' || a.orderstatus = 'order006' || a.orderstatus = 'order007'), 'true', 'false') ELSE if(a.orderstatus = 'order005' || a.orderstatus = 'order006' || a.orderstatus = 'order007', 'true', 'false') END ) AS reviewBtn, if(b.contentsType = 'goods' && b.deliveryMethod = 'delivery' && (a.orderstatus = 'order005' || a.orderstatus = 'order006' || a.orderstatus = 'order015' || a.orderstatus = 'order016'), 'true', 'false') AS trackingViewBtn, if(b.contentsType = 'goods' && (a.orderstatus = 'order002' || a.orderstatus = 'order003'), 'true','false') AS addressChangeBtn FROM orderproduct a, product b WHERE a.productId = b.productId AND a.orderProductId = @{orderProductId} "
                  }
                }
              }
            }
          }
        },
        "delivery":{
          "typeId" : "delivery",
          "query" : [
            {"field" : "orderSheetId", "method" : "equals", "value" : "{{:orderSheetId}}"},
            {"field" : "deliveryType", "method" : "equals", "value" : "deliveryAddress"}
          ]
        },
        "payment":{
          "typeId" : "payment",
          "query" : [
            {"field" : "ordrIdxx", "method" : "equals", "value" : "{{:orderSheetId}}"}
          ]
        }
      }
    }
  },
  {
    "typeId" : "apiConfig",
    "category" : "orderSheet",
    "apiId" : "list",
    "apiName" : "주문/배송조회 리스트",
    "method" : "GET",
    "parameters" : [
    ],
    "config" : {
      "typeId" : "orderSheet",
      "query" : [
        {"field" : "memberNo", "method" : "equals", "value" : "{{:memberNo}}"},
        {"field" : "orderSheetId", "method" : "equals", "value" : "{{:orderSheetId}}"},
        {"field" : "created", "method" : "fromto", "value" : "{{:createdFromto}}"},
        {"includeReferenced" : true, "sorting" : "orderSheetId desc"},
        {"field" : "referencedOrderProduct", "method" : "hasReferenced", "value" : "productId_equals={{:productId}}&orderStatus_equals={{:orderStatus}}"}
      ],
      "response": {
        "_all_": "",
        "referencedOrderProduct" : {
          "typeId" : "orderProduct",
          "query" : [
            {"field" : "orderSheetId", "method" : "equals", "value" : "{{:orderSheetId}}"},
            {"field" : "productId", "method" : "equals", "value" : "{{:productId}}"},
            {"includeReferenced" : true, "referenceView": "productId,deliveryEnterpriseId"}
          ],
          "response": {
            "_all_": "",
            "referencedOrderDeliveryPrice" : {
              "select": {
                "ds": "ytnDevDb",
                "resultType": "read",
                "description": "주문배송비 정보",
                "sql": "select a.orderDeliveryPriceId ,a.orderSheetId ,a.orderProductIds ,a.vendorId ,a.deliveryPrice ,a.bundleDeliveryYn ,a.deliveryMethod ,a.deliveryPriceType ,a.couponId ,a.deliveryEnterpriseId ,a.sendingDate ,a.trackingNo ,a.deliveryStatus ,a.deliveryDateType ,a.scheduledDeliveryDate ,a.hopeDeliveryDate ,a.changed ,a.created ,b.name ,b.deliverySearchUrl ,b.deliveryEnterpriseStatus from orderdeliveryprice a LEFT JOIN deliveryenterprise b on a.deliveryEnterpriseId = b.deliveryEnterpriseId where a.orderSheetId= @{orderSheetId} and find_in_set( @{orderProductId},a.orderProductIds) "
              }
            },
            "functionBtn": {
              "select": {
                "ds": "ytnDevDb",
                "resultType": "read",
                "description": "버튼 조회 정보",
                "sql": "SELECT if(a.orderstatus = 'order002' || a.orderstatus = 'order003', 'true', 'false') AS cancelBtn, if(b.contentsType = 'goods' && (a.orderstatus = 'order005' || a.orderstatus = 'order006'), 'true', 'false') AS exchangeBtn, if(b.contentsType = 'goods' && (a.orderstatus = 'order005' || a.orderstatus = 'order006'), 'true', 'false') AS returnBtn, (CASE WHEN b.contentsType = 'goods' THEN if((SELECT IFNULL(max(if((sendingDate + INTERVAL 30 DAY) >= now(), TRUE, FALSE)), FALSE)FROM orderdeliveryprice WHERE find_in_set(@{orderProductId}, orderProductIds) > 0) && (a.orderstatus = 'order005' || a.orderstatus = 'order006' || a.orderstatus = 'order007'), 'true', 'false') ELSE if(a.orderstatus = 'order005' || a.orderstatus = 'order006' || a.orderstatus = 'order007', 'true', 'false') END ) AS reviewBtn, if(b.contentsType = 'goods' && b.deliveryMethod = 'delivery' && (a.orderstatus = 'order005' || a.orderstatus = 'order006' || a.orderstatus = 'order015' || a.orderstatus = 'order016'), 'true', 'false') AS trackingViewBtn, if(b.contentsType = 'goods' && (a.orderstatus = 'order002' || a.orderstatus = 'order003'), 'true','false') AS addressChangeBtn FROM orderproduct a, product b WHERE a.productId = b.productId AND a.orderProductId = @{orderProductId} "
              }
            }
          }
        }
      }
    }
  },
  {
    "typeId" : "apiConfig",
    "category" : "orderSheet",
    "apiId" : "recentlyList",
    "apiName" : "최근 주문/배송조회 리스트",
    "method" : "GET",
    "parameters" : [
    ],
    "config" : {
      "typeId" : "orderSheet",
      "query" : [
        {"field" : "memberNo", "method" : "equals", "value" : "{{:memberNo}}"},
        {"field" : "orderSheetId", "method" : "equals", "value" : "{{:orderSheetId}}"},
        {"field" : "created", "method" : "above", "value" : "{{:now}}"},
        {"includeReferenced" : true, "sorting" : "orderSheetId desc"},
        {"field" : "referencedOrderProduct", "method" : "hasReferenced", "value" : "productId_equals={{:productId}}&orderStatus_equals={{:orderStatus}}"}
      ],
      "response": {
        "_all_": "",
        "referencedOrderProduct" : {
          "typeId" : "orderProduct",
          "query" : [
            {"field" : "orderSheetId", "method" : "equals", "value" : "{{:orderSheetId}}"},
            {"field" : "productId", "method" : "equals", "value" : "{{:productId}}"},
            {"includeReferenced" : true, "referenceView": "productId,deliveryEnterpriseId"}
          ],
          "response": {
            "_all_": "",
            "referencedOrderDeliveryPrice" : {
              "select": {
                "ds": "ytnDevDb",
                "resultType": "read",
                "description": "주문배송비 정보",
                "sql": "select a.orderDeliveryPriceId ,a.orderSheetId ,a.orderProductIds ,a.vendorId ,a.deliveryPrice ,a.bundleDeliveryYn ,a.deliveryMethod ,a.deliveryPriceType ,a.couponId ,a.deliveryEnterpriseId ,a.sendingDate ,a.trackingNo ,a.deliveryStatus ,a.deliveryDateType ,a.scheduledDeliveryDate ,a.hopeDeliveryDate ,a.changed ,a.created ,b.name ,b.deliverySearchUrl ,b.deliveryEnterpriseStatus from orderdeliveryprice a LEFT JOIN deliveryenterprise b on a.deliveryEnterpriseId = b.deliveryEnterpriseId where a.orderSheetId= @{orderSheetId} and find_in_set( @{orderProductId},a.orderProductIds) "
              }
            },
            "functionBtn": {
              "select": {
                "ds": "ytnDevDb",
                "resultType": "read",
                "description": "버튼 조회 정보",
                "sql": "SELECT if(a.orderstatus = 'order002' || a.orderstatus = 'order003', 'true', 'false') AS cancelBtn, if(b.contentsType = 'goods' && (a.orderstatus = 'order005' || a.orderstatus = 'order006'), 'true', 'false') AS exchangeBtn, if(b.contentsType = 'goods' && (a.orderstatus = 'order005' || a.orderstatus = 'order006'), 'true', 'false') AS returnBtn, (CASE WHEN b.contentsType = 'goods' THEN if((SELECT IFNULL(max(if((sendingDate + INTERVAL 30 DAY) >= now(), TRUE, FALSE)), FALSE)FROM orderdeliveryprice WHERE find_in_set(@{orderProductId}, orderProductIds) > 0) && (a.orderstatus = 'order005' || a.orderstatus = 'order006' || a.orderstatus = 'order007'), 'true', 'false') ELSE if(a.orderstatus = 'order005' || a.orderstatus = 'order006' || a.orderstatus = 'order007', 'true', 'false') END ) AS reviewBtn, if(b.contentsType = 'goods' && b.deliveryMethod = 'delivery' && (a.orderstatus = 'order005' || a.orderstatus = 'order006' || a.orderstatus = 'order015' || a.orderstatus = 'order016'), 'true', 'false') AS trackingViewBtn, if(b.contentsType = 'goods' && (a.orderstatus = 'order002' || a.orderstatus = 'order003'), 'true','false') AS addressChangeBtn FROM orderproduct a, product b WHERE a.productId = b.productId AND a.orderProductId = @{orderProductId} "
              }
            }
          }
        }
      }
    }
  },
  {
    "typeId" : "apiCategory",
    "id" : "orderChange",
    "categoryName" : "취소교한반품 API"
  },
  {
    "typeId" : "apiConfig",
    "category" : "orderChange",
    "apiId" : "list",
    "apiName" : "취소교환반품 조회 리스트",
    "method" : "GET",
    "parameters" : [
    ],
    "config" : {
      "typeId" : "orderChange",
      "query" : [
        {"field" : "memberNo", "method" : "equals", "value" : "{{:memberNo}}"},
        {"field" : "orderSheetId", "method" : "equals", "value" : "{{:orderSheetId}}"},
        {"field" : "changeType", "method" : "equals", "value" : "{{:changeType}}"},
        {"field" : "created", "method" : "fromto", "value" : "{{:createdFromto}}"},
        {"includeReferenced" : true, "sorting" : "orderChangeId desc"},
        {"field" : "referencedOrderChangeProduct", "method" : "hasReferenced", "value" : "productId_equals={{:productId}}"}
      ],
      "response": {
        "_all_": "",
        "referencedOrderChangeProduct" : {
          "typeId" : "orderChangeProduct",
          "query" : [
            {"field" : "orderChangeId", "method" : "equals", "value" : "{{:orderChangeId}}"},
            {"field" : "productId", "method" : "equals", "value" : "{{:productId}}"},
            {"includeReferenced" : true, "referenceView": "productId"}
          ],
          "response": {
            "_all_": "",
            "referencedOrderChangeDeliveryPrice" : {
              "select": {
                "ds": "ytnDevDb",
                "resultType": "read",
                "description": "주문배송비 정보",
                "sql": "SELECT a.*, b.name, b.deliverySearchUrl, b.deliveryEnterpriseStatus FROM orderChangeDeliveryPrice a LEFT JOIN deliveryenterprise b ON a.deliveryEnterpriseId = b.deliveryEnterpriseId WHERE a.orderChangeId = @{orderChangeId} AND find_in_set( @{orderChangeProductId}, a.orderChangeProductIds)"
              }
            },
            "functionBtn": {
              "select": {
                "ds": "ytnDevDb",
                "resultType": "read",
                "description": "버튼 조회 정보",
                "sql": "SELECT if(b.contentsType = 'goods' && b.deliveryMethod = 'delivery' && (a.orderstatus = 'order015' || a.orderstatus = 'order016'), 'true', 'false') AS trackingViewBtn FROM orderproduct a, product b WHERE a.productId = b.productId AND a.orderProductId = @{orderProductId} "
              }
            }
          }
        }
      }
    }
  },
  {
    "typeId" : "apiConfig",
    "category" : "orderChange",
    "apiId" : "read",
    "apiName" : "취소교환반품 조회",
    "method" : "GET",
    "parameters" : [
    ],
    "config" : {
      "typeId" : "orderChange",
      "query" : [
        {"field" : "orderChangeId", "method" : "matching", "value" : "{{:orderChangeId}}"},
        {"includeReferenced" : true, "referenceView": "memberNo"}
      ],
      "response": {
        "_all_": "",
        "referencedOrderChangeProduct" : {
          "typeId" : "orderChangeProduct",
          "query" : [
            {"field" : "orderChangeId", "method" : "equals", "value" : "{{:orderChangeId}}"},
            {"includeReferenced" : true, "referenceView": "orderProductIds, productId"}
          ],
          "response": {
            "_all_": "",
            "referencedOrderChangeDeliveryPrice" : {
              "select": {
                "ds": "ytnDevDb",
                "resultType": "read",
                "description": "주문배송비 정보",
                "sql": "SELECT a.*, b.name, b.deliverySearchUrl, b.deliveryEnterpriseStatus FROM orderChangeDeliveryPrice a LEFT JOIN deliveryenterprise b ON a.deliveryEnterpriseId = b.deliveryEnterpriseId WHERE a.orderChangeId = @{orderChangeId} AND find_in_set( @{orderChangeProductId}, a.orderChangeProductIds)"
              }
            },
            "functionBtn": {
              "select": {
                "ds": "ytnDevDb",
                "resultType": "read",
                "description": "버튼 조회 정보",
                "sql": "SELECT if(b.contentsType = 'goods' && b.deliveryMethod = 'delivery' && (a.orderstatus = 'order015' || a.orderstatus = 'order016'), 'true', 'false') AS trackingViewBtn FROM orderproduct a, product b WHERE a.productId = b.productId AND a.orderProductId = @{orderProductId} "
              }
            }
          }
        },
        "delivery":{
          "typeId" : "delivery",
          "query" : [
            {"field" : "orderSheetId", "method" : "equals", "value" : "{{:orderSheetId}}"},
            {"field" : "deliveryType", "method" : "notEquals", "value" : "deliveryAddress"}
          ]
        },
        "payment":{
          "typeId" : "payment",
          "query" : [
            {"field" : "ordrIdxx", "method" : "equals", "value" : "{{:orderSheetId}}"}
          ]
        }
      }
    }
  }
]