[
  {
    "typeId" : "apiCategory",
    "id" : "orderSheet",
    "categoryName" : "주문서 API"
  },
  {
    "typeId" : "apiConfig",
    "category" : "orderSheet",
    "apiId" : "read",
    "apiName" : "주문서 조회",
    "method" : "GET",
    "parameters" : [
    ],
    "config" : {
      "typeId" : "orderSheet",
      "query" : [
        {"field" : "orderSheetId", "method" : "matching", "value" : "{{:orderSheetId}}"},
        {"referenceView": "memberNo"}
      ],
      "response": {
        "_all_": "",
        "referencedOrderDeliveryPrice" : {
          "typeId" : "orderDeliveryPrice",
          "query" : [
            {"sorting" : "orderDeliveryPriceId desc,created desc"},
            {"field" : "orderSheetId", "method" : "equals", "value" : "{{:orderSheetId}}"},
            {"includeReferenced" : true, "referenceView": "orderProductIds, productId, deliveryEnterpriseId"}
          ]
        },
        "delivery":{
          "select": {
            "ds": "ytnDevDb",
            "resultType": "read",
            "description": "배송지",
            "sql": "select * from delivery where orderSheetId = @{orderSheetId} "
          }
        },
        "payment":{
          "select": {
            "ds": "ytnDevDb",
            "resultType": "read",
            "description": "결제정보",
            "sql": "select * from payment where ordrIdxx = @{orderSheetId} "
          }
        }
      }
    }
  },
  {
    "typeId" : "apiConfig",
    "category" : "orderSheet",
    "apiId" : "list",
    "apiName" : "주문/배송조회 리스트",
    "method" : "GET",
    "parameters" : [
    ],
    "config" : {
      "typeId" : "orderSheet",
      "query" : [
        {"field" : "memberNo", "method" : "equals", "value" : "{{:memberNo}}"},
        {"field" : "orderSheetId", "method" : "equals", "value" : "{{:orderSheetId}}"},
        {"field" : "created", "method" : "fromto", "value" : "{{:createdFromto}}"},
        {"includeReferenced" : true, "sorting" : "created desc"},
        {"field" : "referencedOrderProduct", "method" : "hasReferenced", "value" : "productId_equals={{:productId}}&orderStatus_equals={{:orderStatus}}"}
      ],
      "response": {
        "_all_": "",
        "referencedOrderProduct" : {
          "typeId" : "orderProduct",
          "query" : [
            {"field" : "orderSheetId", "method" : "equals", "value" : "{{:orderSheetId}}"},
            {"field" : "productId", "method" : "equals", "value" : "{{:productId}}"},
            {"includeReferenced" : true, "referenceView": "productId,deliveryEnterpriseId"}
          ],
          "response": {
            "_all_": "",
            "referencedOrderDeliveryPrice" : {
              "select": {
                "ds": "ytnDevDb",
                "resultType": "read",
                "description": "주문배송비 정보",
                "sql": "select a.orderDeliveryPriceId ,a.orderSheetId ,a.orderProductIds ,a.vendorId ,a.deliveryPrice ,a.bundleDeliveryYn ,a.deliveryMethod ,a.deliveryPriceType ,a.couponId ,a.deliveryEnterpriseId ,a.sendingDate ,a.trackingNo ,a.deliveryStatus ,a.deliveryDateType ,a.scheduledDeliveryDate ,a.hopeDeliveryDate ,a.changed ,a.created ,b.name ,b.deliverySearchUrl ,b.deliveryEnterpriseStatus from orderdeliveryprice a LEFT JOIN deliveryenterprise b on a.deliveryEnterpriseId = b.deliveryEnterpriseId where a.orderSheetId= @{orderSheetId} and find_in_set( @{orderProductId},a.orderProductIds) "
              }
            }
          }
        }
      }
    }
  }
]